"0","library(flextable)"
"0",""
"0","region.name <- c(""Africa"", ""Arab States"", ""Asia & Pacific"","
"0","                                 ""Europe"", ""Middle east"", ""North America"","
"0","                                 ""South/Latin America"")"
"0","avg_co2_com_1990 = NULL"
"0","for(i in 1:nrow(energy)){"
"0","  for(y in 1:7){"
"0","    if(energy$Region[i] == region.name[y]){"
"0","      avg_co2_com_1990[y] = mean(energy$co2_fuel_com[energy$Region == region.name[y] & energy$Year == 1990])"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","avg_co2_com_2020 = NULL"
"0","for(i in 1:nrow(energy)){"
"0","  for(y in 1:7){"
"0","    if(energy$Region[i] == region.name[y]){"
"0","      avg_co2_com_2020[y] = mean(energy$co2_fuel_com[energy$Region == region.name[y] & energy$Year == 2020])"
"0","    }"
"0","  }"
"0","}"
"0",""
"0",""
"0",""
"0","tab.df <- data.frame(Region = region.name,"
"0","                    avg_co2_com_1990 = round(avg_co2_com_1990, 1),"
"0","                    avg_co2_com_2020 = round(avg_co2_com_2020, 1),"
"0","                    Change = round(avg_co2_com_2020 - avg_co2_com_1990, 1))"
"0","table <- flextable(tab.df)"
"0","table <- add_header_row(x = table, values = c("""", ""Average CO2 Emissions from Fuel"
"0","                                              Combustion (Mt)"", """"),"
"0","                 colwidths = c(1, 2, 1))"
"0","table <- align(table, i = 1, part = ""header"", align = ""center"")"
"0","table <- labelizor(table, part = ""header"","
"0","                 labels = c(""avg_co2_com_1990"" = ""1990"","
"0","                            ""avg_co2_com_2020"" = ""2020"","
"0","                            ""Change"" = ""Change""))"
"0","table <- autofit(table)"
"0","table <- footnote(table, i = 1, j = 2,"
"0","                  value = as_paragraph(""Mt = million tons""),"
"0","                  ref_symbols = ""a"","
"0","                  part = ""header"")"
"0","table"
